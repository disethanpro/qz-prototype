<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ›²è½´æ£€æµ‹æ ¸å¿ƒæµç¨‹å›¾ï¼ˆå­æµç¨‹ï¼‰</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'SimHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            animation: fadeIn 0.8s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 3px solid #667eea;
            position: relative;
        }

        h1 {
            font-size: 2.8em;
            color: #2c3e50;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.2em;
            color: #7f8c8d;
            font-weight: 300;
            margin-top: 10px;
        }

        .info-box {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }

        .info-box h3 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: 1.3em;
        }

        .info-box ul {
            list-style: none;
            padding-left: 0;
        }

        .info-box li {
            padding: 8px 0;
            color: #34495e;
            line-height: 1.6;
            position: relative;
            padding-left: 25px;
        }

        .info-box li:before {
            content: "â–¸";
            position: absolute;
            left: 5px;
            color: #667eea;
            font-weight: bold;
        }

        .diagram-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
            margin-bottom: 30px;
        }

        #mermaidDiagram {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 25px;
        }

        .btn {
            padding: 12px 28px;
            font-size: 1em;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(245, 87, 108, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 172, 254, 0.4);
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 25px;
            border-top: 2px solid #ecf0f1;
            color: #7f8c8d;
            font-size: 0.95em;
        }

        .legend {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-top: 25px;
        }

        .legend h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }

        .legend-color {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .legend-text {
            flex: 1;
            font-size: 0.95em;
            color: #34495e;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 2em;
            }

            .controls {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }

        /* Mermaid æ ·å¼ä¼˜åŒ– */
        .mermaid svg {
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ”§ æ›²è½´æ£€æµ‹æ ¸å¿ƒæµç¨‹å›¾</h1>
            <p class="subtitle">ä¸‰é¡¹æ£€æµ‹è¯¦ç»†æµç¨‹ Â· è·³åŠ¨é‡ Â· ç²—ç³™åº¦ Â· ç›´å¾„</p>
        </header>

        <div class="info-box">
            <h3>ğŸ“‹ æ£€æµ‹æµç¨‹è¯´æ˜</h3>
            <ul>
                <li><strong>æ£€æµ‹å¯¹è±¡ï¼š</strong>DF8Bå‹å·ï¼ˆ9ä¸ªè½´é¢ˆï¼‰/ HXN5Bå‹å·ï¼ˆ7ä¸ªè½´é¢ˆï¼‰</li>
                <li><strong>æ£€æµ‹é¡¹ç›®ï¼š</strong>è·³åŠ¨é‡æ£€æµ‹ â†’ ç²—ç³™åº¦æ£€æµ‹ï¼ˆRaï¼‰ â†’ ç›´å¾„æ£€æµ‹</li>
                <li><strong>æ£€æµ‹ç­–ç•¥ï¼š</strong>å•é¡¹ä¸åˆæ ¼æ ‡è®°ä½†ç»§ç»­æ£€æµ‹ï¼Œæœ€ç»ˆç»¼åˆåˆ¤å®š</li>
                <li><strong>å¼‚å¸¸å¤„ç†ï¼š</strong>è®¾å¤‡å¼‚å¸¸æ—¶ç«‹å³åœæ­¢å¹¶è®°å½•ï¼Œæ”¯æŒæ–­ç‚¹æ¢å¤</li>
            </ul>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="zoomIn()">ğŸ” æ”¾å¤§</button>
            <button class="btn btn-primary" onclick="zoomOut()">ğŸ” ç¼©å°</button>
            <button class="btn btn-secondary" onclick="resetZoom()">â†º é‡ç½®è§†å›¾</button>
            <button class="btn btn-success" onclick="exportDiagram()">ğŸ’¾ å¯¼å‡ºå›¾ç‰‡</button>
        </div>

        <div class="diagram-container" id="diagramContainer">
            <div class="execution-order" style="background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%); padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center; border: 2px solid #667eea;">
                <strong style="color: #667eea; font-size: 1.1em;">âš™ï¸ æ‰§è¡Œé¡ºåºï¼šè·³åŠ¨é‡æ£€æµ‹ â†’ ç²—ç³™åº¦æ£€æµ‹ â†’ ç›´å¾„æ£€æµ‹ï¼ˆæœ¬å›¾æŒ‰æ¨¡å—å±•ç¤ºï¼‰</strong>
            </div>
            <div id="mermaidDiagram" class="mermaid">
flowchart TD
    A[å¼€å§‹æœ¬æ›²è½´æ£€æµ‹] --> B[æŒ‰å‹å·ç¡®å®šè½´é¢ˆæ•°é‡ N<br/>DF8B=9 / HXN5B=7]
    B --> START_INSPECT[å¼€å§‹ä¸‰é¡¹æ£€æµ‹]

    %% è·³åŠ¨é‡æ£€æµ‹æ¨¡å—
    START_INSPECT --> T_START[è·³åŠ¨é‡æ£€æµ‹]
    subgraph S1[" è·³åŠ¨é‡æ£€æµ‹æ¨¡å— "]
        T_START --> T1[é©±åŠ¨ç”µæœºæ—‹è½¬æ›²è½´<br/>è·³åŠ¨é‡ä¼ æ„Ÿå™¨æŒç»­é‡‡æ ·]
        T1 --> T2[éšæœºé€‰å– 3 ç§’åçš„ç‚¹<br/>ä½œä¸ºæ ‡å‡†ç‚¹]
        T2 --> T3[æŒ‰ 0.01â€³ é¢‘ç‡å–æ ·<br/>è®¡ç®—å„ç‚¹ä¸æ ‡å‡†ç‚¹å·®å€¼ç»å¯¹å€¼æœ€å¤§å€¼]
        T3 --> T4[ä¸è·³åŠ¨é‡é™å€¼æ¯”è¾ƒ<br/>å¾—åˆ°å½“å‰è½´é¢ˆåˆ¤å®š]
        T4 --> T5{æ˜¯å¦è¿˜æœ‰æœªæµ‹è½´é¢ˆ?}
        T5 -->|æ˜¯| T1
        T5 -->|å¦| T6[ç”Ÿæˆè·³åŠ¨é‡ç»“æœè¡¨<br/>ç¼–å· / è·³åŠ¨é‡å€¼ / åˆ¤å®š]
    end

    %% ç²—ç³™åº¦æ£€æµ‹æ¨¡å—
    T6 --> R_START[ç²—ç³™åº¦æ£€æµ‹]
    subgraph S2[" ç²—ç³™åº¦æ£€æµ‹æ¨¡å— Ra "]
        R_START --> R1[æ”¯æ’‘æ¿1å°±ä½<br/>ç²—ç³™åº¦ä¼ æ„Ÿå™¨åˆ°ä½]
        R1 --> R2[è½´é¢ˆå¾ªç¯ 1..N<br/>æ›²è½´æ—‹è½¬ï¼Œå®æ—¶è¯»å–è¡¨é¢é«˜åº¦å˜åŒ–]
        R2 --> R3[è®¡ç®—å•è½´é¢ˆ Ra å€¼ Î¼m]
        R3 --> R4[ä¸ Ra é™å€¼æ¯”è¾ƒ<br/>ä¸åŒå‹å·é™å€¼å¯é…ç½®ï¼Œä¾‹å¦‚ DF8B: Ra â‰¤ 0.25Î¼m]
        R4 --> R5{æ˜¯å¦è¿˜æœ‰æœªæµ‹è½´é¢ˆ?}
        R5 -->|æ˜¯| R2
        R5 -->|å¦| R6[ç”Ÿæˆç²—ç³™åº¦ç»“æœè¡¨<br/>ç¼–å· / Ra å€¼ / åˆ¤å®š]
    end

    %% ç›´å¾„æ£€æµ‹æ¨¡å—
    R6 --> D_START[ç›´å¾„æ£€æµ‹]
    subgraph S3[" ç›´å¾„æ£€æµ‹æ¨¡å— "]
        D_START --> D1[æ›´æ¢æ”¯æ’‘æ¿2<br/>åŒæ¿€å…‰ç›´å¾„ä¼ æ„Ÿå™¨å°±ä½]
        D1 --> D2[æµ‹é‡ä¼ æ„Ÿå™¨1ã€2å½“å‰ä½ç½®<br/>ä½ç½® -50 ç¡®è®¤ 0 ç‚¹]
        D2 --> D3[è½´é¢ˆå¾ªç¯ 1..N<br/>æ¯è½´é¢ˆæµ‹å·¦/å³ä¸¤ç‚¹]
        D3 --> D4[åŒæ­¥é‡‡é›†ä¼ æ„Ÿå™¨1/2æ•°å€¼]
        D4 --> D5[ä¸¤æ•°å€¼ç›¸åŠ å–ç»å¯¹å€¼<br/>ä¸æ ‡ç§°å°ºå¯¸åŠå…¬å·®æ¯”è¾ƒ]
        D5 --> D6[è¾“å‡ºå½“å‰è½´é¢ˆæ•°æ®<br/>ä¼ æ„Ÿå™¨1å€¼ / ä¼ æ„Ÿå™¨2å€¼ / å·®å€¼ / å½“å‰è½´é¢ˆåˆ¤å®š]
        D6 --> D7{æ˜¯å¦è¿˜æœ‰æœªæµ‹è½´é¢ˆ?}
        D7 -->|æ˜¯| D3
        D7 -->|å¦| D8[ç”Ÿæˆç›´å¾„ç»“æœè¡¨<br/>ç¼–å· / ä¼ æ„Ÿå™¨1 / ä¼ æ„Ÿå™¨2 / å·®å€¼ / åˆ¤å®š]
        D8 --> D9[ç›´å¾„é¡¹ç›®æ•´ä½“åˆ¤å®š<br/>ä»»ä¸€è½´é¢ˆç›´å¾„ä¸åˆæ ¼ï¼Œåˆ™ç›´å¾„æ£€æµ‹æ•´ä½“ä¸åˆæ ¼]
    end

    %% ä¸‰é¡¹ç»“æœæ±‡æ€»åˆ°æ•´æœºç»“æœ
    T6 --> FINAL[æ•´æœºç»“æœåˆ¤å®š]
    R6 --> FINAL
    D9 --> FINAL

    FINAL[æ•´æœºç»“æœï¼šç»¼åˆè·³åŠ¨é‡ / ç²—ç³™åº¦ / ç›´å¾„ä¸‰é¡¹<br/>åˆ¤å®šæ•´æ ¹æ›²è½´åˆæ ¼ / ä¸åˆæ ¼<br/>æ£€æµ‹è¿‡ç¨‹ä¸­å•é¡¹ä¸åˆæ ¼ä»…åšæ ‡è®°ï¼Œä¸æå‰ç»ˆæ­¢å‰©ä½™æ£€æµ‹]

    %% è®¾å¤‡å¼‚å¸¸é€šç”¨å¤„ç†
    A -. ä»»ä½•é˜¶æ®µ .-> X[è®¾å¤‡å¼‚å¸¸å¤„ç†è¯´æ˜:<br/>æœºæ¢°è‡‚æŠ¥è­¦/æ€¥åœ/è¶Šç•Œ â†’ ç«‹å³åœæ­¢æ£€æµ‹ï¼Œè®°å½•æ£€æµ‹ä¸­æ–­<br/>ä¼ æ„Ÿå™¨é€šè®¯ä¸­æ–­/é©±åŠ¨å¼‚å¸¸ â†’ åœæ­¢å½“å‰é¡¹ç›®å¹¶æç¤ºé”™è¯¯<br/>æ–­ç”µ/ç¨‹åºå¼‚å¸¸ â†’ è‡ªåŠ¨ä¿å­˜ä¸ºæ£€æµ‹ä¸­æ–­ï¼Œé‡å¯å¤ä½]

    %% æ ·å¼å®šä¹‰
    style A fill:#e1f5e1,stroke:#4caf50,stroke-width:3px
    style B fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style START_INSPECT fill:#e1f5e1,stroke:#4caf50,stroke-width:2px
    
    style T_START fill:#cfe2ff,stroke:#0d6efd,stroke-width:2px
    style T2 fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style T5 fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style T6 fill:#d1ecf1,stroke:#0dcaf0,stroke-width:2px
    
    style R_START fill:#cfe2ff,stroke:#0d6efd,stroke-width:2px
    style R5 fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style R6 fill:#d1ecf1,stroke:#0dcaf0,stroke-width:2px
    
    style D_START fill:#cfe2ff,stroke:#0d6efd,stroke-width:2px
    style D7 fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style D8 fill:#d1ecf1,stroke:#0dcaf0,stroke-width:2px
    style D9 fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    
    style FINAL fill:#d1e7dd,stroke:#198754,stroke-width:3px
    style X fill:#f8d7da,stroke:#dc3545,stroke-width:2px
            </div>
        </div>

        <div class="legend">
            <h4>ğŸ“Š å›¾ä¾‹è¯´æ˜</h4>
            <div class="legend-grid">
                <div class="legend-item">
                    <div class="legend-color" style="background: #e1f5e1;"></div>
                    <div class="legend-text"><strong>å¼€å§‹èŠ‚ç‚¹</strong> - æ£€æµ‹æµç¨‹èµ·ç‚¹</div>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #fff3cd;"></div>
                    <div class="legend-text"><strong>é…ç½®/åˆ¤æ–­</strong> - å‹å·é…ç½®ã€æ¡ä»¶åˆ¤æ–­</div>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #cfe2ff;"></div>
                    <div class="legend-text"><strong>æ£€æµ‹è¿‡ç¨‹</strong> - ä¸‰é¡¹ä¸»è¦æ£€æµ‹æµç¨‹</div>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #d1ecf1;"></div>
                    <div class="legend-text"><strong>ç»“æœè¾“å‡º</strong> - ç”Ÿæˆæ£€æµ‹ç»“æœè¡¨</div>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #d1e7dd;"></div>
                    <div class="legend-text"><strong>å®ŒæˆèŠ‚ç‚¹</strong> - æ£€æµ‹å®Œæˆã€ç»¼åˆåˆ¤å®š</div>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #f8d7da;"></div>
                    <div class="legend-text"><strong>å¼‚å¸¸å¤„ç†</strong> - è®¾å¤‡å¼‚å¸¸å¤„ç†è¯´æ˜</div>
                </div>
            </div>
        </div>

        <div class="info-box" style="margin-top: 30px;">
            <h3>ğŸ” ä¸‰é¡¹æ£€æµ‹è¯¦ç»†è¯´æ˜</h3>
            <ul>
                <li><strong>è·³åŠ¨é‡æ£€æµ‹ï¼š</strong>ç”µæœºé©±åŠ¨æ›²è½´æ—‹è½¬ï¼Œä¼ æ„Ÿå™¨æŒç»­é‡‡æ ·ï¼Œ3ç§’åéšæœºé€‰å–æ ‡å‡†ç‚¹ï¼ŒæŒ‰0.01â€³é¢‘ç‡å–æ ·è®¡ç®—æœ€å¤§åå·®</li>
                <li><strong>ç²—ç³™åº¦æ£€æµ‹ï¼š</strong>æ”¯æ’‘æ¿1å°±ä½ï¼Œä¼ æ„Ÿå™¨è¯»å–è¡¨é¢é«˜åº¦å˜åŒ–ï¼Œè®¡ç®—Raå€¼ï¼ˆÎ¼mï¼‰ï¼Œé™å€¼å¯é…ç½®ï¼ˆDF8B: Raâ‰¤0.25Î¼mï¼‰</li>
                <li><strong>ç›´å¾„æ£€æµ‹ï¼š</strong>æ”¯æ’‘æ¿2å°±ä½ï¼ŒåŒæ¿€å…‰ä¼ æ„Ÿå™¨åŒæ­¥é‡‡é›†å·¦å³ä¸¤ç‚¹ï¼Œä»»ä¸€è½´é¢ˆä¸åˆæ ¼åˆ™ç›´å¾„é¡¹ç›®æ•´ä½“ä¸åˆæ ¼</li>
                <li><strong>ç»¼åˆåˆ¤å®šï¼š</strong>ä¸‰é¡¹ç»“æœè¡¨åˆ†åˆ«ç”Ÿæˆåæ±‡æ€»ï¼Œç»¼åˆåˆ¤å®šæ•´æ ¹æ›²è½´åˆæ ¼/ä¸åˆæ ¼ï¼Œå•é¡¹ä¸åˆæ ¼ä»…æ ‡è®°ä¸ç»ˆæ­¢</li>
            </ul>
        </div>

        <footer>
            <p>æ›²è½´æ£€æµ‹æ ¸å¿ƒæµç¨‹å›¾ï¼ˆå­æµç¨‹ï¼‰ | ç”Ÿæˆæ—¶é—´: <span id="datetime"></span></p>
            <p style="margin-top: 8px; font-size: 0.9em;">ä¸‰é¡¹æ£€æµ‹æ¨¡å— Â· è¯¦ç»†æµç¨‹æ§åˆ¶ Â· è®¾å¤‡å¼‚å¸¸å¤„ç†</p>
        </footer>
    </div>

    <script>
        // åˆå§‹åŒ– Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis',
                padding: 20,
                nodeSpacing: 80,
                rankSpacing: 80
            },
            themeVariables: {
                primaryColor: '#cfe2ff',
                primaryTextColor: '#000',
                primaryBorderColor: '#0d6efd',
                lineColor: '#495057',
                secondaryColor: '#e1f5e1',
                tertiaryColor: '#fff3cd',
                fontSize: '16px',
                fontFamily: 'Microsoft YaHei, SimHei, Arial, sans-serif'
            }
        });

        // ç¼©æ”¾åŠŸèƒ½
        let currentZoom = 1;
        const zoomStep = 0.1;
        const minZoom = 0.3;
        const maxZoom = 3;

        function zoomIn() {
            if (currentZoom < maxZoom) {
                currentZoom += zoomStep;
                applyZoom();
            }
        }

        function zoomOut() {
            if (currentZoom > minZoom) {
                currentZoom -= zoomStep;
                applyZoom();
            }
        }

        function resetZoom() {
            currentZoom = 1;
            applyZoom();
        }

        function applyZoom() {
            const diagram = document.getElementById('mermaidDiagram');
            diagram.style.transform = `scale(${currentZoom})`;
            diagram.style.transformOrigin = 'top center';
        }

        // å¯¼å‡ºå›¾ç‰‡åŠŸèƒ½
        async function exportDiagram() {
            try {
                const svgElement = document.querySelector('#mermaidDiagram svg');
                if (!svgElement) {
                    alert('æœªæ‰¾åˆ°æµç¨‹å›¾ï¼Œè¯·ç¨åå†è¯•');
                    return;
                }

                // åˆ›å»º canvas
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                // è·å– SVG å°ºå¯¸
                const bbox = svgElement.getBBox();
                const scale = 2; // æé«˜å¯¼å‡ºè´¨é‡
                canvas.width = bbox.width * scale;
                canvas.height = bbox.height * scale;
                
                // è®¾ç½®ç™½è‰²èƒŒæ™¯
                ctx.fillStyle = 'white';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // å°† SVG è½¬æ¢ä¸ºå›¾ç‰‡
                const svgData = new XMLSerializer().serializeToString(svgElement);
                const img = new Image();
                const blob = new Blob([svgData], { type: 'image/svg+xml;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                
                img.onload = function() {
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    URL.revokeObjectURL(url);
                    
                    // ä¸‹è½½å›¾ç‰‡
                    canvas.toBlob(function(blob) {
                        const link = document.createElement('a');
                        link.download = 'æ›²è½´æ£€æµ‹æ ¸å¿ƒæµç¨‹å›¾.png';
                        link.href = URL.createObjectURL(blob);
                        link.click();
                    });
                };
                
                img.src = url;
            } catch (error) {
                console.error('å¯¼å‡ºå¤±è´¥:', error);
                alert('å¯¼å‡ºå›¾ç‰‡å¤±è´¥ï¼Œè¯·ä½¿ç”¨æµè§ˆå™¨çš„æ‰“å°åŠŸèƒ½æˆ–æˆªå›¾å·¥å…·');
            }
        }

        // æ›´æ–°æ—¶é—´
        function updateDateTime() {
            const now = new Date();
            const options = {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            };
            document.getElementById('datetime').textContent = now.toLocaleString('zh-CN', options);
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        window.addEventListener('load', function() {
            updateDateTime();
            
            // æ·»åŠ é”®ç›˜å¿«æ·é”®
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey || e.metaKey) {
                    if (e.key === '=' || e.key === '+') {
                        e.preventDefault();
                        zoomIn();
                    } else if (e.key === '-') {
                        e.preventDefault();
                        zoomOut();
                    } else if (e.key === '0') {
                        e.preventDefault();
                        resetZoom();
                    }
                }
            });
        });

        // æ·»åŠ æ‹–æ‹½åŠŸèƒ½
        let isDragging = false;
        let startX, startY, scrollLeft, scrollTop;

        const container = document.getElementById('diagramContainer');

        container.addEventListener('mousedown', function(e) {
            if (e.target === container || e.target.closest('.mermaid')) {
                isDragging = true;
                container.style.cursor = 'grabbing';
                startX = e.pageX - container.offsetLeft;
                startY = e.pageY - container.offsetTop;
                scrollLeft = container.scrollLeft;
                scrollTop = container.scrollTop;
            }
        });

        container.addEventListener('mouseleave', function() {
            isDragging = false;
            container.style.cursor = 'default';
        });

        container.addEventListener('mouseup', function() {
            isDragging = false;
            container.style.cursor = 'default';
        });

        container.addEventListener('mousemove', function(e) {
            if (!isDragging) return;
            e.preventDefault();
            const x = e.pageX - container.offsetLeft;
            const y = e.pageY - container.offsetTop;
            const walkX = (x - startX) * 1.5;
            const walkY = (y - startY) * 1.5;
            container.scrollLeft = scrollLeft - walkX;
            container.scrollTop = scrollTop - walkY;
        });
    </script>
</body>
</html>

